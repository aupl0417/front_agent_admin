(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"7htp":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":t.append,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.closeDialog,title:t.dialog.title,visible:t.dialog.visible,width:"400px"},on:{"update:visible":function(e){t.$set(t.dialog,"visible",e)}}},[a("el-form",{ref:"infoForm",staticClass:"l-margin-r",attrs:{"label-width":"90px",model:t.dialog.data,rules:t.dialog.rules},nativeOn:{submit:function(t){t.preventDefault()},keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submitDialog(e):null}}},[a("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[a("el-input",{attrs:{maxlength:50},model:{value:t.dialog.data.name,callback:function(e){t.$set(t.dialog.data,"name",e)},expression:"dialog.data.name"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:t.dialog.data.remark,callback:function(e){t.$set(t.dialog.data,"remark",e)},expression:"dialog.data.remark"}})],1)],1),a("span",{staticClass:"l-margin-r-m",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{white:""},on:{click:function(e){t.closeDialog()}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.dialog.loading},on:{click:t.submitDialog}},[t._v(t._s(t.dialog.loading?"提交中...":"确定提交"))])],1)],1)},n=[],l=(a("91GP"),a("VRzm"),{name:"dialog-department",props:{visible:{type:Boolean,default:!1},formType:{type:String,default:"new"},formData:Object,append:{type:Boolean,default:!1}},data:function(){return{dialog:{title:"新增部门",visible:!1,loading:!1,rules:{name:[{required:!0,message:"必选项",trigger:"blur"}]},data:{parentId:null,id:null,name:"",remark:""}}}},watch:{visible:{immediate:!0,handler:function(t){t&&this.showDialog()}}},methods:{showDialog:function(){"edit"===this.formType?(this.dialog.title="修改部门",this.$utils.copyObj(this.dialog.data,this.formData)):(this.dialog.title="新增部门",this.$utils.copyObj(this.dialog.data,"")),this.dialog.visible=!0},closeDialog:function(t){t?t():this.dialog.visible=!1,this.$emit("update:visible",this.dialog.visible)},submitDialog:function(){var t=this;this.$refs.infoForm.validate(function(e){if(e){var a=Object.assign({},t.dialog.data),i="edit"==t.formType?t.$api.department.edit(a):t.$api.department.add(a);t.dialog.loading=!0,i.then(function(e){var a=e.data;t.$message.success(t.dialog.title+"成功"),t.$emit("change",a),t.closeDialog()}).finally(function(){t.dialog.loading=!1})}else t.$message.error("请完善表单信息")})}}}),o=l,s=(a("JRIF"),a("KHd+")),r=Object(s["a"])(o,i,n,!1,null,"1a74a212",null);e["a"]=r.exports},CFoE:function(t,e,a){"use strict";var i=a("tQH2"),n=a.n(i);n.a},Idqg:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":t.append,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.closeDialog,title:t.dialog.title,visible:t.dialog.visible,width:"400px"},on:{"update:visible":function(e){t.$set(t.dialog,"visible",e)}}},[a("el-form",{ref:"infoForm",staticClass:"l-dialog-form l-margin-r",attrs:{"label-width":"90px",model:t.dialog.data,rules:t.dialog.rules},nativeOn:{submit:function(t){t.preventDefault()},keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submitDialog(e):null}}},[a("el-form-item",{attrs:{label:"所属部门",prop:"parentId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门"},model:{value:t.dialog.data.parentId,callback:function(e){t.$set(t.dialog.data,"parentId",e)},expression:"dialog.data.parentId"}},t._l(t.departmentList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),a("el-form-item",{attrs:{label:"岗位名称",prop:"name"}},[a("el-input",{attrs:{maxlength:50},model:{value:t.dialog.data.name,callback:function(e){t.$set(t.dialog.data,"name",e)},expression:"dialog.data.name"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:t.dialog.data.remark,callback:function(e){t.$set(t.dialog.data,"remark",e)},expression:"dialog.data.remark"}})],1)],1),a("span",{staticClass:"l-margin-r-m",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{white:""},on:{click:function(e){t.closeDialog()}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.dialog.loading},on:{click:t.submitDialog}},[t._v(t._s(t.dialog.loading?"提交中...":"确定提交"))])],1)],1)},n=[],l=(a("91GP"),a("xfY5"),a("VRzm"),{name:"dialog-position",props:{visible:{type:Boolean,default:!1},formType:{type:String,default:"new"},formData:Object,parentId:[String,Number],append:{type:Boolean,default:!1}},data:function(){return{departmentList:[],dialog:{title:"新增岗位",visible:!1,loading:!1,rules:{parentId:[{required:!0,message:"必选项",trigger:"blur"}],name:[{required:!0,message:"必选项",trigger:"blur"}]},data:{parentId:null,id:null,name:"",remark:""}}}},watch:{visible:{immediate:!0,handler:function(t){t&&this.showDialog()}}},methods:{getDepartmentList:function(){var t=this;return this.$api.department.getDownList().then(function(e){var a=e.data;return t.departmentList=a,Promise.resolve(a)})},showDialog:function(){var t=this;this.getDepartmentList().finally(function(){"edit"===t.formType?(t.dialog.title="修改岗位",t.$utils.copyObj(t.dialog.data,t.formData)):(t.dialog.title="新增岗位",t.$utils.copyObj(t.dialog.data,""),t.dialog.data.parentId=t.parentId),t.dialog.visible=!0})},closeDialog:function(t){t?t():this.dialog.visible=!1,this.$emit("update:visible",this.dialog.visible)},submitDialog:function(){var t=this;this.$refs.infoForm.validate(function(e){if(e){var a=Object.assign({},t.dialog.data),i="edit"==t.formType?t.$api.department.edit(a):t.$api.department.add(a);t.dialog.loading=!0,i.then(function(e){var a=e.data;t.$message({type:"success",message:t.dialog.title+"成功"}),t.$emit("change",a),t.closeDialog()}).finally(function(){t.dialog.loading=!1})}else t.$message({type:"error",message:"请完善表单信息"})})}}}),o=l,s=(a("wfFR"),a("KHd+")),r=Object(s["a"])(o,i,n,!1,null,"e098ecb2",null);e["a"]=r.exports},JRIF:function(t,e,a){"use strict";var i=a("q3GG"),n=a.n(i);n.a},PYnm:function(t,e,a){},QJH9:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticClass:"l-h100"},[a("el-header",{staticClass:"l-padding-0 l-bg-white",attrs:{height:"auto"}},[a("div",{staticClass:"l-filter-top"},[a("ul",{staticClass:"l-tab-tit"},[a("li",{on:{click:function(e){t.$router.push("/user/list")}}},[t._v("账号列表")]),a("li",{staticClass:"_active2"},[t._v("部门岗位管理")])]),a("el-form",{ref:"listFilter",staticClass:"l-filter-form",attrs:{inline:"",model:t.list.filter,rules:t.list.rules},nativeOn:{submit:function(t){t.preventDefault()},keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}}},[a("el-form-item",{staticClass:"l-margin-r"},[a("el-input",{staticStyle:{width:"320px"},attrs:{placeholder:"请输入部门/岗位名称"},model:{value:t.list.filter.keywords,callback:function(e){t.$set(t.list.filter,"keywords",e)},expression:"list.filter.keywords"}})],1),a("el-form-item",{staticClass:"l-margin-r"},[a("el-button",{attrs:{type:"success"},nativeOn:{click:function(e){t.search()}}},[t._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{type:"warning"},nativeOn:{click:function(e){t.departmentDialog("new")}}},[t._v("新增部门")])],1)],1)],1)]),a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.list.loading,expression:"list.loading"}],attrs:{border:"","element-loading-spinner":"el-icon-loading","element-loading-text":"拼命加载中",data:t.list.data,"span-method":t.mergeRow}},[a("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"80"}}),a("el-table-column",{attrs:{"class-name":"l-txt-blod",prop:"department",align:"center",label:"部门名称",width:"120"}}),a("el-table-column",{attrs:{prop:"departmentId",align:"center",label:"部门操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"l-txt-link",attrs:{type:"text",size:"mini"},nativeOn:{click:function(a){t.departmentDialog("edit",e.row)}}},[t._v("编辑部门")]),a("el-button",{staticClass:"l-txt-link",attrs:{type:"text",size:"mini"},nativeOn:{click:function(a){t.positionDialog("new",e.row)}}},[t._v("添加岗位")])]}}])}),a("el-table-column",{attrs:{prop:"position",align:"center",label:"岗位名称",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:"岗位操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.positionId?[a("el-button",{staticClass:"l-txt-link",attrs:{type:"text",size:"mini"},nativeOn:{click:function(a){t.positionDialog("edit",e.row)}}},[t._v("编辑岗位")])]:void 0}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center","min-width":"200"}})],1),a("dialog-department",{attrs:{visible:t.department.visible,"form-type":t.department.type,"form-data":t.department.data},on:{"update:visible":function(e){t.$set(t.department,"visible",e)},change:t.getList}}),a("dialog-position",{attrs:{visible:t.position.visible,"form-type":t.position.type,"form-data":t.position.data,"parent-id":t.position.departmentId},on:{"update:visible":function(e){t.$set(t.position,"visible",e)},change:t.getList}})],1),a("el-footer",{staticClass:"l-flex-vhc",attrs:{height:"40px"}},[a("pagination",{attrs:{pager:t.list.pager},on:{change:t.getList,"update:pager":function(e){t.$set(t.list,"pager",e)}}})],1)],1)},n=[],l=(a("f3/d"),a("VRzm"),a("ZAdF")),o=a("7htp"),s=a("Idqg"),r={name:"department-list",components:{dialogDepartment:o["a"],dialogPosition:s["a"],pagination:l["a"]},data:function(){return{list:{filter:{keywords:""},rules:{keywords:[]},pager:{page:1,rows:100,total:0},loading:!1,data:[]},department:{visible:!1,type:"new",data:{id:null,name:null,remark:null}},position:{visible:!1,type:"new",departmentId:"",data:{parentId:null,id:null,name:null,remark:null}}}},methods:{getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.list.pager.page,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.list.pager.rows;this.list.loading=!0,this.$api.department.getList(this.list.filter,e,a).then(function(i){var n=i.data;t.$utils.copyObj(t.list.pager,n,{page:e,rows:a}),t.list.rowspan={},n.list=n.list.map(function(e){return e.parentId>0?(e.departmentId=e.parentId,e.positionId=e.id,e.position=e.name,t.list.rowspan[e.departmentId]?t.list.rowspan[e.departmentId]++:t.list.rowspan[e.departmentId]=1):(e.departmentId=e.id,e.department=e.name,e.positionId="",e.position="无"),e}),t.list.data=n.list.filter(function(e){return e.positionId||!t.list.rowspan[e.departmentId]})}).finally(function(){t.list.loading=!1})},mergeRow:function(t){var e=t.row,a=t.columnIndex;if(1===a||2===a)return e.parentId>0?e.parentId===this.list["parentId_"+a]?{rowspan:0,colspan:0}:(this.list["parentId_"+a]=e.parentId,{rowspan:this.list.rowspan[e.parentId]||1,colspan:1}):{rowspan:1,colspan:1}},search:function(){this.getList(1)},clear:function(){this.$refs.listFilter&&this.$refs.listFilter.resetFields(),this.getList(1)},departmentDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new",e=arguments.length>1?arguments[1]:void 0;this.department.type=t,"edit"===t&&this.$utils.copyObj(this.department.data,{id:e.departmentId,name:e.department,remark:e.remark}),this.department.visible=!0},positionDialog:function(t,e){this.position.type=t,this.position.departmentId=e.departmentId,"edit"===t&&this.$utils.copyObj(this.position.data,{parentId:e.departmentId,id:e.positionId,name:e.position,remark:e.remark}),this.position.visible=!0}},mounted:function(){this.getList()}},d=r,p=a("KHd+"),u=Object(p["a"])(d,i,n,!1,null,null,null);e["default"]=u.exports},ZAdF:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.pager.total>0,expression:"pager.total > 0"}],attrs:{layout:"total, sizes, prev, pager, next, jumper","page-sizes":t.$api.pageSizes,"page-size":t.pager.rows,"current-page":t.pager.page,total:t.pager.total},on:{"size-change":t.sizeChange,"current-change":t.pageChange,"update:pageSize":function(e){t.$set(t.pager,"rows",e)},"update:currentPage":function(e){t.$set(t.pager,"page",e)}}})},n=[],l=(a("xfY5"),a("pIFo"),{name:"pagination",components:{},props:{pager:{type:Object,default:function(){return{page:1,rows:10,total:0}}}},data:function(){return{}},methods:{sizeChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;this.$storage.local.set(this.$route.path+"-table_rows",t),this.$emit("change",1,t)},pageChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$utils.history.replace(this.$utils.url.setArgs(this.$route.fullPath,"_page",t)),this.$emit("change",t,this.pager.rows)},initPager:function(){var t=this.$storage.local.get(this.$route.path+"-table_rows"),e=Number(this.$route.query._page)||1;t&&(this.pager.rows=t),e&&(this.pager.page=e)}},mounted:function(){this.initPager()}}),o=l,s=(a("CFoE"),a("KHd+")),r=Object(s["a"])(o,i,n,!1,null,"d7519360",null);e["a"]=r.exports},q3GG:function(t,e,a){},tQH2:function(t,e,a){},wfFR:function(t,e,a){"use strict";var i=a("PYnm"),n=a.n(i);n.a}}]);
//# sourceMappingURL=8.61f3c2b2.js.map